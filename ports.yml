# restricted xmlrcp access on local network: 
include_config_file: "/etc/ejabberd/xmlrpc.cfg"

listen: 
#Defined in xmlrpc.cfg for tighter access controls
#  - ip: 'INTERNAL_IP'
#    port: 4560
  - ip: "::"
    port: 5061
    module: ejabberd_sip
    tls: true
    certfile: 'CERT_LOCATION'
    access: local
  - ip: "::"
    port: 5222
    module: ejabberd_c2s
    max_stanza_size: 65536
    shaper: c2s_shaper
    access: local
    starttls_required: true
    protocol_options: 'TLS_OPTIONS'
    ciphers: 'TLS_CIPHERS'
    # WARNING: Do not enable zlib on ejabberd-14.07 or earlier, see:
    #   https://github.com/processone/ejabberd/commit/7bdc1151b
    zlib: true
  - ip: "::"
    port: 5269
    module: ejabberd_s2s_in
  - ip: 'INTERNAL_IP'
    port: 5280
    module: ejabberd_http
    request_handlers: 
      "presence": mod_webpresence
      "ws": ejabberd_http_ws
    access: webchat
    http_bind: true
    captcha: true
  - ip: "127.0.0.1"
    port: 5281
    module: ejabberd_http
    web_admin: true
  - ip: "::"
    port: 5349
    module: ejabberd_stun
    tls: true
    certfile: 'CERT_LOCATION'
    use_turn: true
    turn_ip: "128.130.95.63"
    turn_min_port: 49152
    turn_max_port: 50000
    access: local
  - ip: "127.0.0.1"
    port: 5401
    module: ejabberd_service
    hosts: 
      "icq.jabber.at": 
        password: 'ICQ_JABBER_AT_PASSWORD'
    access: local
  - ip: "127.0.0.1"
    port: 5403
    module: ejabberd_service
    hosts: 
      "aim.jabber.at": 
        password: 'AIM_JABBER_AT_PASSWORD'
    access: local
  - ip: "127.0.0.1"
    port: 5404
    module: ejabberd_service
    hosts: 
      "gg.jabber.at": 
        password: 'GG_JABBER_AT_PASSWORD'
    access: local
  # TLS-protected http services
  - port: 5443
    module: ejabberd_http
    request_handlers: 
      "presence": mod_webpresence
      "ws": ejabberd_http_ws
    access: webchat
    http_bind: true
    tls: true
    certfile: 'CERT_LOCATION'
    ciphers: 'TLS_SECURE_CIPHERS'
    protocol_options: 'TLS_OPTIONS'
# port 7777  is configured by mod_proxy65

outgoing_s2s_families: 
  - ipv6
  - ipv4

outgoing_s2s_port: 5269
outgoing_s2s_timeout: 10000
s2s_policy: authenticated
s2s_certfile: 'CERT_LOCATION'
s2s_use_starttls: required
s2s_protocol_options: 'TLS_OPTIONS'
s2s_ciphers: 'TLS_CIPHERS'

######################
### Global Section ###
######################
# Names this node should listen on. Note that you will have to configure a
# host_config section, before you can actually use a new server.
hosts: 
  - "jabber.at"
  - "jabber.fsinf.at"
  - "fsinf.at"
  - "anon.jabber.at"
  - "jabber.wien"
  - "jabber.zone"

# only one registration per hour per IP:
language: "en"
auth_method: internal
registration_timeout: 3600
captcha_cmd: "/usr/lib/ejabberd/priv/bin/captcha.sh"
captcha_host: "https://jabber.at:443"
loglevel: 2
shaper: 
  normal: 500
  proxy: 3000
  fast: 50000

# The default ciphers-setting is found here:
#    https://github.com/processone/tls/blob/master/c_src/p1_tls_drv.c
# We use the default and exclude a few additional ciphers classified as weak
# by xmpp.net.
define_macro:
  'TLS_OPTIONS':
    - "no_sslv2"
    - "no_sslv3"
  'TLS_CIPHERS': "DEFAULT:!EXPORT:!LOW:!RC4:!SSLv2:!DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!ECDHE-RSA-DES-CBC3-SHA:!CAMELLIA128-SHA:!CAMELLIA256-SHA:!SEED-SHA:!AES128-SHA:!AES128-SHA256:!AES128-GCM-SHA256"
  'TRANSPORTS':
    - "aim.jabber.at"
    - "gg.jabber.at"
    - "icq.jabber.at"
    - "simple.jabber.at"
    - "yahoo.jabber.at"    

#####################
### Include files ###
#####################
include_config_file:
  "/etc/ejabberd/secrets.yml": []
  "/etc/ejabberd/acl.yml": []
  "/etc/ejabberd/access.yml": []
#  "/etc/ejabberd/blocked.yml": []
  "/etc/ejabberd/ports.yml": []
  "/etc/ejabberd/modules.yml": []

##########################
### Host configuration ###
##########################
host_config: 
  "jabber.at":
    domain_certfile: 'CERT_LOCATION_JABBER_AT'
    acl: 
      admin: 
        user: 
          - "ra": "jabber.at"
          - "klausi": "jabber.at"

  "anon.jabber.at":
    domain_certfile: 'CERT_LOCATION_JABBER_AT'
    auth_method: [anonymous]
    anonymous_protocol: both

  "jabber.fsinf.at":
    domain_certfile: 'CERT_LOCATION_JABBER_FSINF_AT'
  "fsinf.at": 
    domain_certfile: 'CERT_LOCATION_FSINF_AT'
  "jabber.zone":
    domain_certfile: 'CERT_LOCATION_JABBER_ZONE'
    auth_password_format: scram
  "jabber.wien":
    domain_certfile: 'CERT_LOCATION_JABBER_WIEN'
    auth_password_format: scram

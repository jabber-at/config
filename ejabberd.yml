######################
### Global Section ###
######################
# Names this node should listen on. Note that you will have to configure a
# host_config section, before you can actually use a new server.
hosts: 
  - "jabber.at"
  - "jabber.fsinf.at"
  - "fsinf.at"
  - "anon.jabber.at"
  - "jabber.wien"
  - "jabber.zone"
  - "xmpp.zone"

# only one registration per hour per IP:
language: "en"
auth_method: internal
auth_password_format: scram
registration_timeout: 3600
captcha_cmd: "/usr/share/ejabberd/captcha.sh"
captcha_host: "https://jabber.at:443"
loglevel: 4
hide_sensitive_log_data: true
shaper: 
  normal: 2000
  proxy: 20000
  fast: 50000

# Disabling digest-md5 SASL mechanism to see what happens when we enable SCRAM
# password hashing.
disable_sasl_mechanisms: 
    - "digest-md5"
    - "x-oauth2"
commands_admin_access: xmlrpc

# The default ciphers-setting is found here:
#    https://github.com/processone/tls/blob/master/c_src/p1_tls_drv.c
# We use the default and exclude a few additional ciphers classified as weak
# by xmpp.net.
define_macro:
  'TLS_OPTIONS':
    - "no_sslv2"
    - "no_sslv3"
  'TLS_CIPHERS': "ECDH:DH:!CAMELLIA128:!3DES:!MD5:!RC4:!aNULL:!NULL:!EXPORT:!LOW:!MEDIUM"
  'TRANSPORTS':
    - "aim.jabber.at"
    - "icq.jabber.at"
  'DEFAULT_ROOM_OPTIONS':
    moderated: false
    members_by_default: false

#####################
### Include files ###
#####################
include_config_file:
  "/etc/ejabberd/secrets.yml": []
  "/etc/ejabberd/acl.yml": []
  "/etc/ejabberd/access.yml": []
#  "/etc/ejabberd/blocked.yml": []
  "/etc/ejabberd/ports.yml": []
  "/etc/ejabberd/modules.yml": []

##########################
### Host configuration ###
##########################
host_config: 
  "jabber.at":
    domain_certfile: 'CERT_LOCATION_JABBER_AT'
    acl: 
      admin: 
        user: 
          - "ra": "jabber.at"
          - "klausi": "jabber.at"
    sql_type: 'SQL_TYPE'
    sql_server: 'SQL_SERVER'
    sql_port: 'SQL_PORT'
    sql_database: 'SQL_DB_JABBER_AT'
    sql_username: 'SQL_USER_JABBER_AT'
    sql_password: 'SQL_PASS_JABBER_AT'

  "anon.jabber.at":
    domain_certfile: 'CERT_LOCATION_JABBER_AT'
    auth_method: [anonymous]
    anonymous_protocol: both

  "jabber.fsinf.at":
    domain_certfile: 'CERT_LOCATION_JABBER_FSINF_AT'
    sql_type: 'SQL_TYPE'
    sql_server: 'SQL_SERVER'
    sql_port: 'SQL_PORT'
    sql_database: 'SQL_DB_JABBER_FSINF_AT'
    sql_username: 'SQL_USER_JABBER_FSINF_AT'
    sql_password: 'SQL_PASS_JABBER_FSINF_AT'
  "fsinf.at": 
    domain_certfile: 'CERT_LOCATION_FSINF_AT'
    sql_type: 'SQL_TYPE'
    sql_server: 'SQL_SERVER'
    sql_port: 'SQL_PORT'
    sql_database: 'SQL_DB_FSINF_AT'
    sql_username: 'SQL_USER_FSINF_AT'
    sql_password: 'SQL_PASS_FSINF_AT'
  "jabber.zone":
    domain_certfile: 'CERT_LOCATION_JABBER_ZONE'
    sql_type: 'SQL_TYPE'
    sql_server: 'SQL_SERVER'
    sql_port: 'SQL_PORT'
    sql_database: 'SQL_DB_JABBER_ZONE'
    sql_username: 'SQL_USER_JABBER_ZONE'
    sql_password: 'SQL_PASS_JABBER_ZONE'
  "jabber.wien":
    domain_certfile: 'CERT_LOCATION_JABBER_WIEN'
    sql_type: 'SQL_TYPE'
    sql_server: 'SQL_SERVER'
    sql_port: 'SQL_PORT'
    sql_database: 'SQL_DB_JABBER_WIEN'
    sql_username: 'SQL_USER_JABBER_WIEN'
    sql_password: 'SQL_PASS_JABBER_WIEN'
  "xmpp.zone":
    domain_certfile: 'CERT_LOCATION_XMPP_ZONE'
    sql_type: 'SQL_TYPE'
    sql_server: 'SQL_SERVER'
    sql_port: 'SQL_PORT'
    sql_database: 'SQL_DB_XMPP_ZONE'
    sql_username: 'SQL_USER_XMPP_ZONE'
    sql_password: 'SQL_PASS_XMPP_ZONE'
